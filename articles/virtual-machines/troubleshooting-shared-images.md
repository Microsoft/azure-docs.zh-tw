---
title: 針對 Azure 中的共用映射問題進行疑難排解
description: 瞭解如何針對共用映射資源庫的問題進行疑難排解。
author: olayemio
ms.service: virtual-machines
ms.subservice: imaging
ms.topic: troubleshooting
ms.workload: infrastructure
ms.date: 10/27/2020
ms.author: olayemio
ms.reviewer: cynthn
ms.openlocfilehash: 9a905dd61bcc267b47dcd075f54a0ed6563a3797
ms.sourcegitcommit: aaa65bd769eb2e234e42cfb07d7d459a2cc273ab
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/27/2021
ms.locfileid: "98879624"
---
# <a name="troubleshoot-shared-image-galleries-in-azure"></a>針對 Azure 中的共用映射資源庫進行疑難排解

如果您在共用映射資源庫、映射定義和映射版本上執行任何作業時遇到問題，請在 [偵測模式] 中再次執行失敗的命令。 您可以 `--debug` 使用 Azure CLI 來傳遞參數，並使用 PowerShell 來傳遞參數，以啟動 debug 模式 `-Debug` 。 當您找到錯誤之後，請遵循本文來進行疑難排解。


## <a name="creating-or-modifying-a-gallery"></a>建立或修改資源庫 ##

*資源庫名稱無效。允許的字元為英文英數位元、具有底線的字元，以及中間允許的期間，最多80個字元。不允許所有其他的特殊字元，包括連字號。*  
**原因**：資源庫的名稱不符合命名需求。  
因應 **措施：請** 選擇符合下列條件的名稱： 
- 具有80個字元的限制
- 僅包含英文字母、數位、底線和句號
- 以英文字母或數位開頭和結尾

*機構名稱 ' galleryName ' 根據其驗證規則無效： ^ [^ \_ \w] [\w-. \_ ] {0,79} (？ <！ [-.]) $。*  
**原因**：資源庫名稱不符合命名需求。  
因應 **措施：選擇** 符合下列條件的資源庫名稱： 
- 具有80個字元的限制
- 僅包含英文字母、數位、底線和句號
- 以英文字母或數位開頭和結尾

*提供的資源名稱 <galleryName \> 具有下列不正確尾端字元： <字元 \> 。名稱不能以字元結尾： <字元\>*  
**原因**：資源庫的名稱以句號或底線結尾。  
因應 **措施：選擇** 符合下列條件的資源庫名稱： 
- 具有80個字元的限制
- 僅包含英文字母、數位、底線和句號
- 以英文字母或數位開頭和結尾

*\>資源類型 ' Microsoft. 計算/資源庫 ' 無法使用提供的位置 <區域。資源類型的可用區域清單為 .。。*  
**原因**：為資源庫指定的區域不正確，或需要存取要求。  
因應 **措施：檢查** 區功能變數名稱稱的拼寫是否正確。 您可以執行此命令來查看您有權存取的區域。 如果區域不在清單中，請提交 [存取要求](/troubleshoot/azure/general/region-access-request-process)。

*刪除嵌套資源之前，無法刪除資源。*  
**原因**：您已嘗試刪除至少包含一個現有映射定義的資源庫。 資源庫必須是空的，才可加以刪除。  
因應 **措施：刪除** 資源庫內的所有映射定義，然後繼續刪除資源庫。 如果映射定義包含映射版本，您必須先刪除映射版本，才能刪除映射定義。

*資源 <galleryName \> 已存在於 \_ \> 資源群組 <resourceGroup 中 <區域1的位置 \> 。無法在 <區域2的位置中建立具有相同名稱的 \_ 資源 \> 。請選取新的資源名稱。*  
**原因**：您在資源群組中有相同名稱的現有資源庫，而且已嘗試使用相同的名稱建立另一個資源庫，但在不同的區域中。  
因應 **措施：請** 使用不同的資源庫，或使用不同的資源群組。

## <a name="creating-or-modifying-image-definitions"></a>建立或修改映射定義 ##

*不允許變更屬性 ' galleryImage. properties. <property \> '。*  
**原因**：您嘗試變更 os 類型、os 狀態、hyper-v 產生、供應專案、發行者或 SKU。 不允許變更這些屬性。  
因應 **措施：改為建立** 新的映射定義。

*資源 <galleryName/imageDefinitionName \> 已經存在於 \_ \> 資源群組 <resourceGroup 中的位置 <區域 1 \> 。無法在 <區域2的位置中建立具有相同名稱的 \_ 資源 \> 。請選取新的資源名稱。*  
**原因**：您在相同的資源庫和資源群組中有相同名稱的現有映射定義。 您嘗試在相同的資源庫中建立另一個具有相同名稱的映射定義，但在不同的區域中。  
因應 **措施：為** 映射定義使用不同的名稱，或將映射定義放在不同的資源庫或資源群組中。

*提供的資源名稱 <galleryName \> /<imageDefinitionName \> 具有這些不正確尾端字元： <字元 \> 。名稱不能以字元結尾： <字元\>*  
**原因**： <imageDefinitionName \> 名稱以句號或底線結尾。  
因應 **措施：選擇** 符合下列條件的映射定義名稱： 
- 具有80個字元的限制
- 僅包含英文字母、數位、底線、連字號和句號
- 以英文字母或數位為開頭和結尾。

*根據其驗證規則，<imageDefinitionName 的機構名稱 \> 無效： ^ [^ \_ \\ W] [ \\ W-. \_ ] {0,79} (？ <！ [-.]) $ "*  
**原因**： <imageDefinitionName \> 名稱以句號或底線結尾。  
因應 **措施：選擇** 符合下列條件的映射定義名稱： 
- 具有80個字元的限制
- 僅包含英文字母、數位、底線、連字號和句號
- 以英文字母或數位開頭和結尾

*資產名稱 galleryImage。 <屬性無效 \> 。不可為空白。允許的字元為大寫或小寫字母、數位、連字號 (-) 、句號 (。 ) ，底線 (\_) 。名稱不能以句點 ( 結尾。 ) 。名稱的長度不能超過 <數位 \> 字元。*  
**原因**：發行者、供應專案或 SKU 值不符合命名需求。  
因應 **措施：選擇** 符合下列條件的值： 
- 供應專案和 SKU 的發行者或64字元限制有128個字元的限制
- 僅包含英文字母、數位、連字號、底線和句號
- 未以句號結尾

*無法在嵌套資源上執行要求的作業。找不到父資源 <galleryName \> 。*  
**原因**：目前 \> 的訂用帳戶和資源群組中沒有名稱為 <galleryName 的資源庫。  
因應 **措施：檢查** 資源庫、訂用帳戶和資源群組的名稱是否正確。 否則，請建立名為 <galleryName 的新資源庫 \> 。

*\>資源類型 ' Microsoft. 計算/資源庫 ' 無法使用提供的位置 <區域。資源類型的可用區域清單為 .。。*  
**原因**： <的區域 \> 名稱不正確，或需要存取要求。  
因應 **措施：檢查** 區功能變數名稱稱的拼寫是否正確。 您可以執行此命令來查看您有權存取的區域。 如果區域不在清單中，請提交 [存取要求](/troubleshoot/azure/general/region-access-request-process)。

*無法將值序列化： <值 \> 的類型： ' iso-8601 '。，ISO8601Error： iso 8601 時間指示項 ' 遺失。無法剖析 datetime 字串 <值\>*  
**原因**：提供給屬性的值未正確格式化為日期。  
因應 **措施：以** yyyy-mm-dd、yyyy-mm-dd dd'T'HH： MM： Sszzz 或 [ISO 8601](https://en.wikipedia.org/wiki/ISO_8601)有效的格式提供日期。

*無法將字串轉換為 DateTimeOffset： <\> 的值。路徑 ' properties. <屬性 \> '*  
**原因**：提供給屬性的值未正確格式化為日期。  
因應 **措施：以** yyyy-mm-dd、yyyy-mm-dd dd'T'HH： MM： Sszzz 或 [ISO 8601](https://en.wikipedia.org/wiki/ISO_8601)有效的格式提供日期。

*EndOfLifeDate 必須設定為未來日期。*  
**原因**：生命循環結束日期屬性未正確格式化為今天日期之後的日期。  
因應 **措施：以** yyyy-mm-dd、yyyy-mm-dd dd'T'HH： MM： Sszzz 或 [ISO 8601](https://en.wikipedia.org/wiki/ISO_8601)有效的格式提供日期。

*引數--<屬性 \> ：不正確 int 值： <值\>*  
**原因**： <屬性 \> 只接受整數值，且 <值 \> 不是整數。  
因應 **措施：選擇** 整數值。

*<屬性的最小值 \> 不得大於 <屬性的最大值 \> 。*  
**原因**：為 <屬性提供的最小值高於 \> 針對 <屬性提供的最大值 \> 。  
因應 **措施：變更** 值，讓最小值小於或等於最大值。

*圖庫映射： \> (發行者所識別的 <imageDefinitionName： <發行者 \> 、供應專案： <供應專案 \> 、SKU： <sku \>) 已存在。選擇不同的發行者、供應專案、sku 組合。*  
**原因**：您嘗試以相同的發行者、供應專案和 SKU 來建立新的映射定義，做為相同資源庫中的現有映射定義。  
因應 **措施：在** 資源庫中，所有影像定義都必須有發行者、供應專案和 SKU 的唯一組合。 選擇唯一的組合，或選擇新的資源庫，然後再次建立映射定義。

*刪除嵌套資源之前，無法刪除資源。*  
**原因**：您已嘗試刪除包含映射版本的映射定義。 映射定義必須是空的，才可加以刪除。  
因應 **措施：刪除** 映射定義內的所有映射版本，然後繼續刪除映射定義。

*無法系結參數 <屬性 \> 。無法將值 <值轉換 \> 為類型 <propertyType \> 。無法將識別碼名稱 <值符合 \> 有效的列舉值名稱。請指定下列其中一個列舉值名稱，然後再試一次： <choice1 \> ，<choice2 \> ，.。。*  
**原因**：屬性有可能值的受限制清單，且 <值 \> 不是其中之一。  
因應 **措施：選擇** 其中一個可能的 <選項 \> 值。

*無法系結參數 <屬性 \> 。無法將值 <值轉換 \> 為類型 system.string &quot;&quot;*  
**原因**：提供給屬性的值未正確格式化為日期。  
因應 **措施：以** yyyy-mm-dd、yyyy-mm-dd dd'T'HH： MM： Sszzz 或 [ISO 8601](https://en.wikipedia.org/wiki/ISO_8601)有效的格式提供日期。

*無法系結參數 <屬性 \> 。無法將值 <值轉換 \> 為類型 &quot; Int32&quot;*  
**原因**： <屬性 \> 只接受整數值，且 <值 \> 不是整數。  
因應 **措施：選擇** 整數值。

*此區域不支援 ZRS 儲存體帳戶類型。*  
**原因**：您已在尚未支援的區域中，選擇標準區域冗余儲存體 (ZRS) 。  
因應 **措施：將** 儲存體帳戶類型變更為 **Premium \_ LRS** 或 **標準 \_ LRS**。 請參閱我們的檔，以取得已啟用 ZRS 預覽版的最新 [區域清單](../storage/common/storage-redundancy.md#zone-redundant-storage) 。

## <a name="creating-or-updating-image-versions"></a>建立或更新映射版本 ##

*\>資源類型 ' Microsoft. 計算/資源庫 ' 無法使用提供的位置 <區域。資源類型的可用區域清單為 .。。*  
**原因**： <的區域 \> 名稱不正確，或需要存取要求。  
因應 **措施：檢查** 區功能變數名稱稱的拼寫是否正確。 您可以執行此命令來查看您有權存取的區域。 如果區域不在清單中，請提交 [存取要求](/troubleshoot/azure/general/region-access-request-process)。

*無法在嵌套資源上執行要求的作業。找不到父資源 <galleryName/imageDefinitionName \> 。*  
**原因**： \> 目前的訂用帳戶和資源群組中沒有名稱為 <galleryName/imageDefinitionName 的資源庫。  
因應 **措施：檢查** 資源庫、訂用帳戶和資源群組的名稱是否正確。 否則，請 \> \> 在指定的資源群組中，使用名稱 <galleryName 和/或名為 <imageDefinitionName 的映射定義來建立新的資源庫。

*無法系結參數 <屬性 \> 。無法將值 <值轉換 \> 為類型 system.string &quot;&quot;*  
**原因**：提供給屬性的值未正確格式化為日期。  
因應 **措施：以** yyyy-mm-dd、yyyy-mm-dd dd'T'HH： MM： Sszzz 或 [ISO 8601](https://en.wikipedia.org/wiki/ISO_8601)有效的格式提供日期。

*無法系結參數 <屬性 \> 。無法將值 <值轉換 \> 為類型 &quot; Int32&quot;*  
**原因**： <屬性 \> 只接受整數值，且 <值 \> 不是整數。  
因應 **措施：選擇** 整數值。

*資源庫映射版本發行設定檔區域 <publishingRegions \> 必須包含映射版本 <sourceRegion 的位置\>*  
**原因**： \> <publishingRegions 清單中必須包含來源映射 ( # B0 sourceRegion) 的位置 \> 。  
因應 **措施：** \> 在 <publishingRegions 清單中包含 <sourceRegion \> 。

*參數 <屬性的值 <值 \> \> 超出範圍。值必須介於 <minValue \> 和 <個 \> （含）之間。*  
**原因**： <值超出 \> <屬性可能值的範圍 \> 。  
因應 **措施：選擇** 在 <minValue 範圍內的值 \> ，以及包含的 <\> 。

*\>找不到來源 <resourceID。請檢查來源是否存在，且與建立的資源庫映射版本位於相同的區域中。*  
**原因**：找不到 <resourceid 的來源 \> ，或 <resourceID 的來源 \> 不在與建立的資源庫映射相同的區域中。  
因應 **措施：檢查**<resourceID \> 值是否正確，以及資源庫映射版本的來源區域是否與 <resourceID 值的區域相同 \> 。

*不允許變更屬性 ' galleryImageVersion. storageProfile. <diskImage \> . source.id '。*  
**原因**：建立之後，無法變更資源庫映射版本的來源識別碼。  
因應 **措施：請** 確認來源識別碼與現有的來源識別碼相同、變更映射版本的版本號碼，或刪除目前的映射版本，然後再試一次。

*在輸入資料磁片中偵測到重複的 lun 編號。每個資料磁片的 Lun 編號都必須是唯一的。*  
**原因**：當您使用磁片和/或磁片快照集的清單建立映射版本時，有兩個或多個磁片或磁片快照集具有相同的 LUN。  
因應 **措施：移除** 或變更任何重複的 lun。

*在輸入磁片中可以找到重複的來源識別碼。每個磁片的來源識別碼都應該是唯一的。*  
**原因**：當您使用磁片和/或磁片快照集清單建立映射版本時，有兩個或多個磁片或磁片快照集具有相同的資源識別碼。  
因應 **措施：移除** 或變更任何重複的磁片來源識別碼。

*\>在路徑 ' storageProfile. <diskImages \> . source.id ' <resourceID 的屬性識別碼無效。預期以 '/subscriptions/{subscriptionId} ' 或 '/providers/{resourceProviderNamespace}/' 開頭的完整資源識別碼。*  
**原因**： <resourceID \> 值的格式不正確。  
因應 **措施：檢查** 資源識別碼是否正確。

*來源識別碼： <resourceID \> 必須是受控映射、虛擬機器或其他資源庫映射版本*  
**原因**： <resourceID \> 值的格式不正確。  
因應 **措施：如果** 您要使用 vm、受控映射或資源庫映射版本作為來源映射，請檢查 vm、受控映射或資源庫映射版本的資源識別碼是否正確。

*來源識別碼： <resourceID \> 必須是受控磁片或快照集。*  
**原因**： <resourceID \> 值的格式不正確。  
因應 **措施：如果** 您使用磁片和/或磁片快照集作為映射版本的來源，請檢查磁片和/或磁片快照集的資源識別碼是否正確。

*無法建立資源庫映射版本來源： <resourceID， \> 因為父資源庫映射中的 OS 狀態 ( # B1 OsState \_ 1 \>) 不 <OsState \_ 2 \> 。*  
**原因**： (一般化或特製化) 的作業系統狀態不符合映射定義中指定的作業系統狀態。  
因應 **措施：請** 根據作業系統狀態為 <OsState 1 的 vm 選擇來源， \_ \> 或為以 <OsState 2 為基礎的 vm 建立新的映射 \_ 定義 \> 。

*識別碼為 ' <resourceID ' 的資源 \> 具有不同的虛擬程式識別碼產生 [' <V # \_ 1 \> ']，而不是父資源庫映射產生器產生 [' <V # \_ 2 \> ']*  
**原因**：映射版本的產生程式產生程式不符合映射定義中指定的程式管理程式產生。 映射定義作業系統是 <V # \_ 1 \> ，映射版本作業系統 <v # \_ 2 \> 。  
因應 **措施：請** 選擇具有與映射定義相同之產生器的來源，或建立/選擇具有與映射版本相同之產生器的新映射定義。

*識別碼為 ' <resourceID ' 的資源 \> 具有不同的 OS 類型 [' <OsType \_ 1 \> ']，而不是父資源庫映射作業系統類型產生 [' <OsType \_ 2 \> ']*  
**原因**：映射版本的產生程式產生程式不符合映射定義中指定的程式管理程式產生。 映射定義作業系統是 <OsType \_ 1 \> ，映射版本作業系統是 <OsType \_ 2 \> 。  
因應 **措施：選擇** 具有相同作業系統的來源 (Linux/Windows) 作為映射定義，或建立/選擇與映射版本具有相同作業系統產生的新映射定義。

*ResourceID <的來源虛擬機器 \> 不能包含暫時性 OS 磁片。*  
**原因**： <resourceID 的來源 \> 包含暫時性 OS 磁片。 共用映射庫目前不支援暫時 OS 磁片。  
因應 **措施：根據** 未使用暫時 OS 磁片的 VM，選擇不同的來源。

*<resourceID 的來源虛擬機器 \> 無法包含 \> 儲存在 UltraSSD 帳戶類型中的磁片 [' <diskID ']。*  
**原因**：磁片 <DiskID \> 是 Ultra SSD 磁片。 共用映射庫目前不支援 Ultra SSD 磁片。  
因應 **措施：使用** 僅包含進階 SSD、標準 SSD 和/或標準 HDD 受控磁片的來源。

*您 \> 必須從受控磁碟建立 <resourceID 的來源虛擬機器。*  
**原因**： <resourceID 中的虛擬機器 \> 使用非受控磁片。  
因應 **措施：根據** 僅包含進階 SSD、標準 SSD 和/或標準 HDD 受控磁片的 VM 來使用來源。

*來源 ' <resourceID ' 的要求太多 \> 。請減少來源的要求數目，或等候一段時間後再重試。*  
**原因**：因為有太多要求，所以此映射版本的來源目前正在進行節流。  
因應 **措施：請** 稍後再嘗試建立映射版本。

*磁片加密集 ' <diskEncryptionSetID \> ' 必須與資源庫資源位於相同的訂用帳戶 ' <subscriptionID \> ' 中。*  
**原因**：磁片加密集只能在其建立所在的相同訂用帳戶和區域中使用。  
因應 **措施：在** 與映射版本相同的訂用帳戶和區域中，建立或使用加密集。

*加密來源： ' <resourceID \> ' 與目前的資源庫映射版本訂用帳戶 ' <subscriptionID 1 ' 位於不同的訂用帳戶識別碼 \_ \> 。請使用未加密的來源 () ，或使用來源的訂用帳戶 ' <subcriptionID \_ 2 \> ' 來建立圖庫映射版本，以重試。*  
**原因**：如果來源映射已加密，共用映射庫目前不支援在另一個來源映射的另一個訂用帳戶中建立映射版本。  
因應 **措施：使用** 未加密的來源，或在與來源相同的訂用帳戶中建立映射版本。

*找不到 <diskEncryptionSetID 的磁片加密集 \> 。*  
**原因**：磁片加密可能不正確。  
因應 **措施：檢查** 磁片加密集的資源識別碼是否正確。

*映射版本名稱無效。映射版本名稱應遵循主要 (int) 。次要 (int) 。Patch (int) 格式，例如：1.0.0、2018.12.1 等。*  
**原因**：映射版本的有效格式是以句號分隔的三個整數。 映射版本名稱不符合有效的格式。  
因應 **措施：使用** 遵循主要 (int) 格式的映射版本名稱。次要 (int) 。Patch (int) 。 例如：1.0.0。 或2018.12.1。

*參數 galleryArtifactVersion 的值無效。 targetRegions. dataDiskImages. diskEncryptionSetId 的值無效*  
**原因**：資料磁片映射上使用的磁片加密集的資源識別碼使用了不正確格式。  
因應 **措施：確定** 磁片加密集的資源識別碼遵循/Subscriptions/<subscriptionID \> /ResourceGroups/<ResourceGroupName \> /providers/Microsoft.Compute/<diskEncryptionSetName 的格式 \> 。

*參數 galleryArtifactVersion 的值無效。 osDiskImage. diskEncryptionSetId 的值無效。*  
**原因**： OS 磁片映射上使用的磁片加密集的資源識別碼使用了不正確格式。  
因應 **措施：確定** 磁片加密集的資源識別碼遵循/Subscriptions/<subscriptionID \> /ResourceGroups/<ResourceGroupName \> /providers/Microsoft.Compute/<diskEncryptionSetName 的格式 \> 。

*無法 \> 在 \> 更新資源庫映射版本要求的區域 [<區域] 中，指定磁片加密集的新資料磁片映射加密 lun [<號碼]。若要更新此版本，請移除新的 lun。如果您需要變更資料磁片映射加密設定，您必須使用正確的設定來建立新的資源庫映射版本。*  
**原因**：您已將加密新增至現有映射版本的資料磁片。 您無法將加密新增至現有的映射版本。  
因應 **措施：建立** 新的資源庫映射版本，或移除新增的加密設定。

*資源庫成品版本來源只能在 storageProfile 或個別的作業系統或資料磁片中直接指定。您可以提供一個唯一的來源類型 (使用者映射、快照集、磁片、虛擬機器) 。*  
**原因**：遺漏來源識別碼。  
因應 **措施：確定** 來源的來源識別碼存在。

*找不到來源： <resourceID \> 。請確認來源存在。*  
**原因**：來源的資源識別碼可能不正確。  
因應 **措施：確定** 來源的資源識別碼正確。

*目的地區域 ' <區域 1 ' 中的磁片 ' galleryArtifactVersion. publishingProfile ' 需要磁片加密集， \_ \> 因為 \> 區域 ' <區域 \_ 2 \> ' 中對應的磁片使用了磁片加密集 ' <diskEncryptionSetId '*  
**原因**：加密已用於 <區域2中的 OS 磁片 \_ \> ，但 <區域1中未使用 \_ \> 。  
因應 **措施：如果** 您是在 OS 磁片上使用加密，請在所有區域中使用加密。

*目的地區域 ' <區域 1 ' 中的磁片 ' LUN <號碼 ' 需要磁片加密集， \> \_ \> 因為 \> 區域 ' <區域 \_ 2 ' 中對應的磁片使用了磁片加密集 ' <diskEncryptionSetID ' \>*  
**原因**：已在 <區域2中的 LUN <編號的資料磁片上使用加密 \> \_ \> ，但在 <區域1中則未使用 \_ \> 。  
因應 **措施：如果** 您是在資料磁片上使用加密，請在所有區域中使用加密。

*在 dataDiskImages 中指定了不正確 lun [<號碼 \> ]。Lun 必須是下列其中一個值 [' 0，9 ']。*  
**原因**：為加密指定的 lun 不符合連接至 VM 之磁片的任何 lun。  
因應 **措施：將** 加密中的 lun 變更為存在於 VM 中的資料磁片 lun。

*\>在目的地區域 ' <區域 ' 加密 dataDiskImages 中指定了重複的 lun ' <號碼 ' \> 。*  
**原因**： <區域中使用的加密設定 \> 至少指定了兩次 LUN。  
因應 **措施：變更**<區域中的 lun \> ，以確定所有 lun 在 <區域中都是唯一的 \> 。

*OSDiskImage 和 DataDiskImage 不能指向相同的 blob <sourceID\>*  
**原因**：作業系統磁片和至少一個資料磁片的來源不是唯一的。  
因應 **措施：變更** 作業系統磁片和/或資料磁片的來源，以確定 os 磁片以及每個資料磁片都是唯一的。

*目標發列區域中不允許重複的區域。*  
**原因**：區域在發列區域中會有一次以上的清單。  
因應 **措施：移除** 重複的區域。

*不允許新增資料磁片或變更現有映射中資料磁片的 LUN。*  
**原因**：映射版本的更新呼叫包含新的資料磁片，或有磁片的新 LUN。  
因應 **措施：使用** 現有映射版本的 lun 和資料磁片。

*磁片加密集 <diskEncryptionSetID \> 必須與資源庫資源位於相同的訂用帳戶 <subscriptionID \> 。*  
**原因**：共用映射庫目前不支援使用不同訂用帳戶中的磁片加密集。  
因應 **措施：在** 相同的訂用帳戶中建立映射版本和磁片加密集。

## <a name="creating-or-updating-a-vm-or-scale-sets-from-an-image-version"></a>從映射版本建立或更新 VM 或擴展集 ##

*用戶端有權在 <resourceID 的範圍中執行 ' Microsoft. Compute/資源庫/images/版本/read ' 動作 \> ，但目前的租使用者 <>tenantid1 \> 未獲授權存取連結的訂用帳戶 <subscriptionId2 \> 。*  
**原因**：虛擬機器或擴展集是透過另一個租使用者中的 SIG 映射建立的。 您已嘗試對虛擬機器或擴展集進行變更，但您沒有擁有該映射之訂用帳戶的存取權。  
因應 **措施：請** 洽詢映射版本訂用帳戶的擁有者，以授與映射版本的讀取權限。

*資源庫映射 <resourceID \> 無法在 <區域區域中使用 \> 。請聯絡映射擁有者，以複寫到此區域，或變更您所要求的區域。*  
**原因**： VM 建立所在的區域不在資源庫映射的已發佈區域清單中。  
因應 **措施：請** 將映射複寫至區域，或在資源庫映射發佈區域的其中一個區域中建立 VM。

*不允許參數 ' osProfile '。*  
**原因**：已為從特殊化映射版本建立的 VM 提供系統管理員使用者名稱、密碼或 SSH 金鑰。  
因應 **措施：如果** 您想要從該映射建立 VM，請不要包含系統管理員使用者名稱、密碼或 SSH 金鑰。 否則，請使用一般化映射版本，並提供管理員使用者名稱、密碼或 SSH 金鑰。

*遺漏必要參數 ' osProfile ' (null) 。*  
**原因**：已從一般化映射建立 VM，但缺少系統管理員使用者名稱、密碼或 SSH 金鑰。 因為一般化映射不會保留系統管理員使用者名稱、密碼或 SSH 金鑰，所以必須在 VM 或擴展集建立期間指定這些欄位。  
因應 **措施：指定** 管理員使用者名稱、密碼或 SSH 金鑰，或使用特製化映射版本。

*無法建立資源庫映射版本來源： <resourceID， \> 因為父資源庫映射中的 OS 狀態 ( ' 特製化 ' ) 不是「一般化」。*  
**原因**：映射版本是從一般化來源建立的，但其父代定義是特製化的。  
因應 **措施：請** 使用特製化來源建立映射版本，或使用一般化的父定義。

*無法更新虛擬機器擴展集 <vmssName， \> 因為 VM 擴展集目前的 OS 狀態是一般化的，不同于已更新的資源庫映射作業系統狀態（特製化）。*  
**原因**：擴展集目前的來源映射是一般化來源映射，但正在以特製化的來源映射進行更新。 目前的來源映射和擴展集的新來源映射必須是相同的狀態。  
因應 **措施：若** 要更新擴展集，請使用一般化映射版本。

*\>共用映射庫中的磁片加密集 <diskEncryptionSetId <versionId \> 屬於訂用帳戶 <subscriptionId1 \> ，且無法與訂用帳戶中的資源 ' ' <subscriptionId2\>*  
**原因**：用來加密映射版本的磁片加密集位於與裝載映射版本的訂用帳戶不同的訂用帳戶中。  
因應 **措施：針對** 映射版本和磁片加密集使用相同的訂用帳戶。

VM 或虛擬機器擴展集建立花費很長的時間。  
因應 **措施：確認** 您嘗試用來建立 VM 或虛擬機器擴展集的映射版本 **OSType** ，與您用來建立映射版本的來源具有相同的 **OSType** 。 

## <a name="creating-a-disk-from-an-image-version"></a>從映射版本建立磁片 ##

*參數 imageReference 的值無效。*  
**原因**：您已嘗試從 SIG 映射版本匯出至磁片，但使用的 LUN 位置不存在於映射中。    
因應 **措施：檢查** 映射版本以查看正在使用的 LUN 位置。

## <a name="sharing-resources"></a>共用資源

在訂用帳戶之間共用映射庫、映射定義和映射版本資源的功能，可使用 [azure 角色型存取控制 (AZURE RBAC) ](../role-based-access-control/rbac-and-directory-admin-roles.md)來啟用。 

## <a name="replication-speed"></a>複寫速度

使用 **--Expand ReplicationStatus** 旗標來檢查複寫到所有指定的目的地區域是否已完成。 如果沒有，請等候最多六個小時讓作業完成。 如果失敗，再次觸發命令來建立和複寫映像版本。 如果有許多目的地區域要複寫至映射版本，請考慮分階段進行複寫。

## <a name="azure-limits-and-quotas"></a>Azure 限制和配額 

[Azure 限制和配額](../azure-resource-manager/management/azure-subscription-service-limits.md)適用於所有的共用映像資源庫、映像定義和映像版本資源。 確定您在訂用帳戶的限制內。 


## <a name="next-steps"></a>後續步驟

深入了解[共用映像資源庫](./shared-image-galleries.md)。
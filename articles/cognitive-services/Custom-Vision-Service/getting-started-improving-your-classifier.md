---
title: 改善您的分類器 - 自訂視覺服務
titleSuffix: Azure Cognitive Services
description: 在本文中，您將瞭解量、品質和各種資料如何在自訂視覺服務中改善分類器的品質。
services: cognitive-services
author: PatrickFarley
manager: nitinme
ms.service: cognitive-services
ms.subservice: custom-vision
ms.topic: conceptual
ms.date: 03/21/2019
ms.author: pafarley
ms.openlocfilehash: c2858d5f9bca662cbbcd48b2345a7dc2c7ae48b2
ms.sourcegitcommit: bc7725874a1502aa4c069fc1804f1f249f4fa5f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/07/2019
ms.locfileid: "73718539"
---
# <a name="how-to-improve-your-classifier"></a>如何改善分類器

在本指南中，您將了解如何改善自訂視覺服務分類器的品質。 分類器品質取決於您提供給它的已標示資料的數量、品質及種類，以及整體資料集的平衡程度。 良好的分類器需要有平衡的定型資料集，而該資料集能充分呈現未來送到分類器的影像內容。 建置這類分類器的程序為迭代過程，或是，多次的實驗，通常要進行幾個回合的定型，才會達到預期的結果。

以下是可協助您建置更精確分類器的一般模式：

1. 第一回合定型
1. 新增更多影像並平衡資料；重新定型
1. 新增背景、光源、物件大小、攝影機角度及樣式各異的影像；重新定型
1. 使用新影像來測試預測
1. 根據預測結果修改現有的定型資料

## <a name="prevent-overfitting"></a>避免過度學習

有時候，分類器會學習如何根據您影像共同的任意特性進行預測。 例如，如果您建立蘋果與柑橘的分類器，且以手拿蘋果與白盤裝柑橘的影像，分類器可能過度重視手與白盤，而不是蘋果與柑橘。

![未預期的分類影像](./media/getting-started-improving-your-classifier/unexpected.png)

若要更正此問題，請使用以下指引，利用更多樣化的影像來定型：提供具有不同角度、背景、物件大小、群組及其他變化的影像。

## <a name="data-quantity"></a>資料品質

定型影像數目是最重要的因素。 我們建議每個標籤至少使用50個影像做為起點。 較少影像可能造成過度學習的風險，雖然您的評估效能可能顯示評估品質良好，但您的模型可能在無法呈現真實世界的資料。 

## <a name="data-balance"></a>資料平衡

此外，務必考慮定型資料的相對數量。 例如，對一個標籤使用 500 個影像且對另一個標籤使用 50 個影像，會讓定型資料集不平衡。 這會導致模型在預測某個標籤會比預測另一個標籤更精確。 如果影像最少的標籤與影像最多的標籤之間可至少維持 1:2 的比例，可能會看到較佳的結果。 例如，如果具有最多影像的標籤有 500 個影像，那麼最少影像的標籤應該至少有 250 個影像用於定型。

## <a name="data-variety"></a>資料多樣性

務必使用代表在正常使用期間將送出到分類器的影像。 否則，分類器可以學習如何根據您影像共同的任意特性進行預測。 例如，如果您建立蘋果與柑橘的分類器，且已使用手拿蘋果與白盤裝柑橘的影像，分類器可能過度重視手與白盤來，而不是蘋果與柑橘。

![未預期的分類影像](./media/getting-started-improving-your-classifier/unexpected.png)

若要更正這個問題，請包含各種影像，以確保分類器可以妥善歸納。 以下一些方式可讓您的定型集更為多元：

* __背景：__ 提供物件在不同背景前方的影像。 自然內容中的相片會將更多資訊提供給分類器，所以比放在中性背景前方的相片更好。

    ![背景範例影像](./media/getting-started-improving-your-classifier/background.png)

* __光源：__ 提供具有各種光源的影像（也就是使用閃光燈、高曝光等等），特別是當用於預測的影像有不同的光源時。 對於使用具有各種飽和度、色調、亮度的影像也很有幫助。

    ![光源範例影像](./media/getting-started-improving-your-classifier/lighting.png)

* __物件大小：__ 提供影像，其中物件的大小和數目各不相同（例如，多串香蕉的相片香蕉和特寫的單一香蕉）。 不同的大小可協助分類器更適當地一般化。

    ![大小範例影像](./media/getting-started-improving-your-classifier/size.png)

* __攝影機角度：__ 提供以不同攝影機角度拍攝的影像。 或者，如果所有相片都必須以固定式攝影機 (例如，監視攝影機) 拍攝，請務必對每個定期發生的物件指派不同的標籤，以避免過度學習 &mdash; 將不相關的物件 (例如，路燈柱) 解釋為主要特徵。

    ![角度範例影像](./media/getting-started-improving-your-classifier/angle.png)

* __樣式：__ 為相同類別的不同樣式提供影像（例如，不同的相同水果）。 不過，如果您有樣式迥異的物件 (例如米老鼠與現實中的老鼠)，建議您分別標示為不同類別，更清楚地表示不同的特徵。

    ![樣式範例影像](./media/getting-started-improving-your-classifier/style.png)

## <a name="negative-images"></a>負面影像

在專案中建議您新增_負面影像_，協助分類器更精確。 負向範例是不符合其他任何標記的範例。 您上傳這些影像時，將特別的 [負向] 標籤套用於影像。

> [!NOTE]
> 自訂視覺服務支援某些自動處理負面影像的功能。 例如，如果您正在建置葡萄與香蕉的分類器，並送出了一隻鞋子的影像進行預測，則分類器應該會針對葡萄與香蕉，將該影像評分為接近 0%。
> 
> 反過來說，如果負面影像只是用來定型之影像的變化，由於相似度極高，模型很可能會將負面影像分類為標記的類別。 例如，柳橙與葡萄柚分類器，但您饋送小柑橘的影像，它可能會將小柑橘評分為柳橙，因為小柑橘有許多和柳橙類似的特徵。 如果是這類負面影像，建議您另外建立一或多個額外標記 (例如「其他」)，並在定型期間以其他」標記來標示負面影像，使模型能更適當區分這些類別。

## <a name="use-prediction-images-for-further-training"></a>使用預測影像以供進一步定型

當您藉由將影像送出到預測端點來使用或測試影像分類器時，自訂視覺服務會儲存這些影像。 您可以接著使用它們來改善模型。

1. 若要查看提交到分類器的影像，請開啟[自訂視覺網頁](https://customvision.ai)，移至您的專案，然後選取 [__預測__] 索引標籤。預設的視圖會顯示來自目前反復專案的影像。 您可以使用 [反覆項目] 下拉式功能表欄位，來檢視在先前反覆項目期間送出的影像。

    ![預測索引標籤的螢幕擷取畫面 (檢視中有影像)](./media/getting-started-improving-your-classifier/predictions.png)

2. 將滑鼠停留在影像上方，以查看由分類器所預測的標記。 影像會排序，如此一來，可為分類器帶來最大改善的影像就會列在最上方。 若要使用不同的排序方法，請在 [排序] 區段中進行選取。 

    若要將影像新增到現有定型資料，請選取影像、設定正確的標記，然後按一下 [儲存並關閉]。 影像將會從 [預測] 中移除並新增到定型影像集。 您可以選取 [定型影像] 索引標籤加以檢視。

    ![標記頁面的影像](./media/getting-started-improving-your-classifier/tag.png)

3. 然後使用 [定型] 按鈕來重塑分類器。

## <a name="visually-inspect-predictions"></a>以視覺化方式檢查預測

若要檢查影像預測，請移至 [定型影像] 索引標籤，在 [反覆項目] 下拉式功能表中選取您先前的定型反覆項目，，然後檢查 [標記] 區段下的一或多個標記。 檢視現在應該在模型無法正確預測指定標記的每個影像周圍顯示紅色方塊。

![反覆項目記錄的影像](./media/getting-started-improving-your-classifier/iteration.png)

有時，視覺檢查可以識別出您接著可藉由新增更多定型資料，或修改現有定型資料來更正的模式。 例如，蘋果與萊姆的分類器錯誤地將所有青蘋果加上萊姆的標籤。 您可接著讓定型資料包含已標記青蘋果的影像，然後新增並提供此定型資料，藉以更正此問題。

## <a name="next-steps"></a>後續步驟

在本指南中，您已了解數種讓自訂影像分類模型更加精確的技術。 接下來，了解如何藉由將影像送出到預測 API，以程式設計方式測試它們。

> [!div class="nextstepaction"]
> [使用預測 API](use-prediction-api.md)

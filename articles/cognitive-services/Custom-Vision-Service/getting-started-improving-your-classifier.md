---
title: 使用自訂視覺服務改善分類器 - Azure 認知服務 | Microsoft Docs
description: 了解如何改善自訂視覺服務分類器的品質。
services: cognitive-services
author: noellelacharite
manager: nolachar
ms.service: cognitive-services
ms.component: custom-vision
ms.topic: article
ms.date: 07/05/2018
ms.author: nolachar
ms.openlocfilehash: 7c6cbd996d0c35b96fde78daf391bebb36feddce
ms.sourcegitcommit: 11321f26df5fb047dac5d15e0435fce6c4fde663
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 07/06/2018
ms.locfileid: "37888168"
---
# <a name="how-to-improve-your-classifier"></a>如何改善分類器

了解如何改善自訂視覺服務分類器的品質。 分類器品質取決於您提供給它的已標示資料數量、品質及種類，以及資料集的平衡程度。 良好的分類器通常具有平衡的定型資料集，而該資料集將提交給分類器的內容具有代表性。 建置這類分類器的程序通常是反覆進行的。 通常要進行幾個回合的定型，才會達到預期的結果。

以下是改善分類器所採取的常見步驟。 這些步驟並非硬性規定，而是可協助您建置更佳的分類器的啟發學習法。

1. 第一回合定型
1. 新增更多影像並平衡資料
1. 重新訓練
1. 新增背景、光源、物件大小、攝影機角度及樣式各異的影像
1. 重新定型並饋送影像進行預測
1. 檢查預測結果
1. 修改現有定型資料

## <a name="data-quantity-and-data-balance"></a>資料數量與資料平衡

最重要的就是上傳足夠的影像將分類器定型。 建議您一開始為定型集的每個標籤都至少上傳 50 個影像。 影像較少時，過度學習的風險很大。 雖然效能數值可能暗示品質良好，但可能難以處理真實世界的資料。 以更多影像定型分類器，通常可以提升預測結果的準確度。

另一個考量是，您應該確定資料之間達到平衡。 例如，一個標籤有 500 個影像，而另一個標籤有 50 個影像，會產生不平衡的定型資料集，導致模型預測某個標籤比另一個標籤更準確。 如果影像最少的標籤與影像最多的標籤之間可至少維持 1:2 的比例，可能會看到較佳的結果。 例如，如果影像數量最多的標籤有 500 個影像，那麼影像數量最少的標籤需要至少有 250 個影像用於定型。

## <a name="train-more-diverse-images"></a>為更多樣化的影像定型

提供代表在正常使用期間將送出到分類器的影像。 例如，您要將「蘋果」分類器定型，如果您只將蘋果裝盤的相片定型，但對蘋果在樹上的相片進行預測，分類器就可能不準確。 請包括各種影像，以確保您的分類器不會產生偏差，而且也能適當地一般化。 以下一些方式可讓您的定型集更為多元：

__背景：__ 提供物件放在不同背景前方的影像 (也就是，水果裝盤與水果裝袋)。 呈現內容的相片會將更多資訊提供給分類器，所以比放在中性背景前方的相片更好。

![背景範例影像](./media/getting-started-improving-your-classifier/background.png)

__光源：__ 提供多樣化光源的影像 (也就是，以閃光燈、高曝光等方式拍攝等)，當用於預測的影像有不同的光源時特別有用。 對於包含具有不同飽和度、色調、亮度的影像也很有幫助。

![光源範例影像](./media/getting-started-improving-your-classifier/lighting.png)

__物件大小：__ 提供物件大小各異、擷取物件不同部分的影像。 例如，多串香蕉的相片和單根香蕉的特寫。 不同的大小可協助分類器更適當地一般化。

![大小範例影像](./media/getting-started-improving-your-classifier/size.png)

__攝影機角度：__ 提供以不同攝影機角度拍攝的影像。 如果所有相片都是以一組固定式攝影機 (例如，監視攝影機) 拍攝的，即使擷取相同物件，也務必對每部攝影機指派不同的標籤，以避免過度學習，而將不相關的物件 (例如，路燈柱) 模型化為主要特徵。

![角度範例影像](./media/getting-started-improving-your-classifier/angle.png)

__樣式：__ 提供類別相同但樣式不同的影像 (也就是，不同種類的柑橘)。 不過，如果影像中的物件樣式迥異 (也就是，米老鼠與現實中的老鼠)，建議您分別標示為不同類別，以更清楚地表示不同的特徵。

![樣式範例影像](./media/getting-started-improving-your-classifier/style.png)

## <a name="use-images-submitted-for-prediction"></a>使用送出來進行預測的影像

自訂視覺服務會儲存送出到預測端點的影像。 若要使用這些影像來改善分類器，請使用下列步驟：

1. 若要檢視送出到分類器的影像，開啟[自訂視覺網頁](https://customvision.ai) \(英文\)，前往您的專案，然後選取 [預測] 索引標籤。預設檢視會顯示來自目前反覆項目的影像。 您可以使用 [反覆項目] 下拉式清單欄位，來檢視在先前反覆項目期間送出的影像。

    ![[預測] 索引標籤的影像](./media/getting-started-improving-your-classifier/predictions.png)

2. 將滑鼠停留在影像上方，以查看由分類器所預測的標記。 影像會設定順位，如此一來，可為分類器帶來最大獲益的影像就會位於最上方。 若要選取不同的排序，使用 [排序] 區段。 若要將影像新增到現有定型資料，請選取影像、選取正確標記，然後按一下 [儲存並關閉]。 從 [預測] 移除影像並新增到定型影像。 您可以選取 [定型影像] 索引標籤加以檢視。

    ![標記頁面的影像](./media/getting-started-improving-your-classifier/tag.png)

3. 使用 [定型] 按鈕來重塑分類器。

## <a name="visually-inspect-predictions"></a>以視覺化方式檢查預測

若要檢查影像預測，選取 [定型影像] 索引標籤，然後選取 [反覆項目記錄]。 錯誤預測的影像具有紅色方塊外框。

![反覆項目記錄的影像](./media/getting-started-improving-your-classifier/iteration.png)

有時，視覺檢查可以識別出您接著可藉由新增其他定型資料，或修改現有定型資料來更正的模式。 例如，蘋果與萊姆的分類器錯誤地將所有青蘋果加上萊姆的標籤。 您可以讓定型資料包含已標記青蘋果的影像，然後新增並提供此定型資料，藉以更正此問題。

## <a name="unexpected-classification"></a>未預期的分類

有時，分類器會錯誤地學習影像所具備的共同特性。 例如，如果您建立蘋果與柑橘的分類器，並提供手拿蘋果與白盤裝柑橘的影像，分類器可能會以手與白盤來定型，而不是蘋果與柑橘。

![未預期的分類影像](./media/getting-started-improving-your-classifier/unexpected.png)

若要更正此問題，請使用上述指引，利用更多樣化的影像來定型：提供具有不同角度、背景、物件大小、群組及其他變化的影像。

## <a name="negative-image-handling"></a>負片處理

自訂視覺服務支援某些自動處理負片的功能。 如果您正在建置葡萄與香蕉的分類器，並送出了一隻鞋子的影像進行預測，則分類器應該會針對葡萄與香蕉，將該影像評分為接近 0%。

反過來說，如果負類影像只是用來定型之影像的變化，由於相似度極高，模型很可能會將負類影像分類為標記的類別。 例如，如果有一個柳橙與葡萄柚分類器，但您饋送小柑橘的影像，它可能會將小柑橘評分為柳橙。 由於小柑橘的許多特徵 (色彩、形狀、紋理、自然產地等) 都和柳橙類似，所以可能會發生這種情形。  如果是這類負類影像，建議您另外建立一或多個標記 (「其他」)，並以此標記來標示負類影像，以讓模型更適當區分這些類別。

## <a name="next-steps"></a>後續步驟

了解您如何藉由提交影像給預測 API，以程式設計方式測試它們。

> [!div class="nextstepaction"]
[使用預測 API](use-prediction-api.md)

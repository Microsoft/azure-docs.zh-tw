---
title: 如何使用語音服務建立語言模型 - Microsoft 認知服務
description: 了解如何在 Microsoft 認知服務中使用語音服務建立語言模型。
services: cognitive-services
author: PanosPeriorellis
ms.service: cognitive-services
ms.component: speech-service
ms.topic: tutorial
ms.date: 06/25/2018
ms.author: panosper
ms.openlocfilehash: d74a5ded7d86969b3ca2cc20a59ddc20af7dc932
ms.sourcegitcommit: 6361a3d20ac1b902d22119b640909c3a002185b3
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/17/2018
ms.locfileid: "49364110"
---
# <a name="tutorial-create-a-custom-language-model"></a>教學課程：建立自訂語言模型

在本文件中，您會建立自訂語言模型。 然後，您可以使用此自訂語言模型搭配 Microsoft 中現有的頂級語音模型，來為您的應用程式新增語音互動。

文件將說明如何：
> [!div class="checklist"]
> * 準備資料
> * 匯入語言資料集
> * 建立自訂語言模型

如果您沒有認知服務帳戶，請在開始前建立[免費帳戶](https://azure.microsoft.com/try/cognitive-services/)。

## <a name="prerequisites"></a>必要條件

若要確定您的認知服務帳戶已連線到訂用帳戶，請開啟[認知服務訂用帳戶](https://customspeech.ai/Subscriptions)頁面。

若要連線到在 Azure 入口網站中建立的語音服務訂用帳戶，請選取 [與現有訂用帳戶連線] 按鈕。

如需在 Azure 入口網站中建立語音服務訂用帳戶的相關資訊，請參閱[開始使用](get-started.md)頁面。

## <a name="prepare-the-data"></a>準備資料

若要為您的應用程式建立自訂語言模型，您需要提供語句範例的清單給系統，例如：

*   「此病患上週長了蕁麻疹。」
*   「病患的疝氣傷口復原得很好。」

句子不需要是完整句或使用正確文法，但應精確地反映在部署中系統預期會出現的語音輸入。 這些範例應反映使用者使用您應用程式時的方式和工作內容。

語言模型的資料應以 UTF-8 BOM 撰寫。 文字檔案中的每一行皆應包含一個範例 (句子、語句或或查詢)。

如果您想讓某些字詞有更高的權重 (重要性)，您可以將包含這些字詞的多個語句新增至您的資料中。 

下表摘要說明語言資料的主要需求。

| 屬性 | 值 |
|----------|-------|
| 文字編碼 | UTF-8 BOM|
| 每一行的語句數目 | 1 |
| 檔案大小上限 | 1.5 GB |
| 備註 | 避免重複字元超過 4 次，例如 'aaaaa'|
| 備註 | 沒有 '\t' 之類的特殊字元，或比 [Unicode 字元資料表](http://www.utf8-chartable.de/)中的 U+00A1 更高的任何其他 UTF-8 字元|
| 備註 | URI 也會遭到拒絕，因為沒有可讀出 URI 的專屬方式|

由於文字匯入時，經過了文字正規化，因此可由系統處理。 不過，有一些重要的正規化，必須由使用者在上傳資料_之前_完成。 請參閱[轉譯指導方針](prepare-transcription.md)，以確認在準備語言資料時所應使用的適當語言。

## <a name="language-support"></a>語言支援

請參閱自訂[語音轉換文字](language-support.md#text-to-speech)語言模型的完整**支援語言**清單。



## <a name="import-the-language-data-set"></a>匯入語言資料集

選取 [語言資料集] 資料列中的 [匯入] 按鈕，網站會顯示上傳新資料集的頁面。

當您準備好匯入您的語言資料集時，請登入[語音服務入口網站](https://customspeech.ai)。 首先，選取頂端功能區的 [自訂語音] 下拉式功能表。 然後選取 [調節資料]。 第一次嘗試將資料上傳到語音服務時，您會看到名為**資料集**的空白資料表。

若要匯入新的資料集，請選取 [語言資料集] 資料列中的 [匯入] 按鈕。 網站會隨即顯示上傳新資料集的頁面。 輸入 [名稱] 和 [描述] 以便日後識別資料集，然後選擇地區設定。 

接著，使用 [選擇檔案] 按鈕尋找語言資料文字檔。 之後，選取 [匯入]，即可上傳資料集。 視資料集的大小而定，匯入作業可能需要數分鐘的時間。

![嘗試](media/stt/speech-language-datasets-import.png)

匯入完成後，語言資料會有與您的語言資料集相對應的項目。 請注意，其已獲派唯一識別碼 (GUID)。 資料也會有狀態來反映其目前的狀態。 當資料排入佇列以進行處理時，其狀態會是「等待中」，資料正在通過驗證時會顯示「處理中」，資料可供使用時，則會顯示「完成」。 資料驗證會對檔案中的文字執行一系列檢查。 此外也會執行資料的某種文字正規化。

當狀態為「完成」時，您可以選取 [檢視報告] 來查看語言資料的驗證報告。 您會看到通過驗證或驗證失敗的語句數目，以及失敗語句的詳細資料。 在下列範例中，有兩個範例會因為不正確的字元而驗證失敗。 (在此資料集中，第一行有兩個 TAB 字元、第二行有數個不在 ASCII 可列印字元集中的字元，而第三行是空白的)。

![嘗試](media/stt/speech-language-datasets-report.png)

當語言的資料集狀態為「完成」時，即可用來建立自訂語言模型。

![嘗試](media/stt/speech-language-datasets.png)

## <a name="create-a-custom-language-model"></a>建立自訂語言模型

當您的語言資料準備就緒之後，請從 [功能表] 下拉式功能表中選取 [語言模型]，以啟動自訂語言模型的建立程序。 此頁面包含名為「語言模型」的資料表，其中包含您目前的自訂語言模型。 如果您尚未建立任何自訂語言模型，此資料表會是空白的。 表格中的相關資料項目旁會顯示目前地區設定。

採取任何動作之前，必須先選取適當的地區設定。 目前的地區設定會標示在所有資料、模型和部署頁面上的資料表標題中。 若要變更地區設定，請選取位於資料表標題下的 [變更地區設定] 按鈕。  這會帶您前往地區設定確認頁面。 選取 [確定] 即可返回資料表。

在 [建立語言模型] 頁面上輸入「名稱」和「描述」，可協助您持續追蹤此模型的相關資訊，例如使用的資料集。 接下來，從下拉式功能表中選取 [基底語言模型]。 此模型是自訂的起點。 

有兩種基底語言模型可選擇。 搜尋與聽寫模型適用於應用程式上的語音導向作業，例如命令、搜尋查詢或聽寫。 對話模型適用於辨識以對話形式說出的語音。 這類型的語音通常會指向另一個人，並且發生在話務中心或會議中。 

搜尋與聽寫模型適用於應用程式上的語音導向作業，例如命令、搜尋查詢或聽寫。 對話模型適用於辨識以對話形式說出的語音。 這類型的語音通常會指向另一個人，並且發生在話務中心或會議中。 稱為「通用」的新模型也已正式推出。 「通用」的目標是處理所有案例，並在最終取代搜尋、聽寫和交談模型。

如下列範例所示，在指定基底語言模型之後，請使用 [語言資料] 下拉式功能表選取您要用於自訂的語言資料集。

![嘗試](media/stt/speech-language-models-create2.png)

與建立原音模型時一樣，您可以選擇是否在處理完成時，對新模型執行離線測試。 模型評估需要原音資料集。

若要為您的語言模型執行離線測試，請選取 [離線測試] 旁的核取方塊。 從下拉式功能表中選取原音模型。 如果您尚未建立任何自訂原音模型，Microsoft 基底原音式模型將會是功能表中唯一的模型。 如果您已挑選交談 LM 基底模型，您需要在此使用交談 AM。 如果您使用搜尋與聽寫 LM 模型，則必須選取搜尋與聽寫 AM 模型。

最後，選取您要用來執行評估的原音資料集。

當您準備好要啟動處理程序時，請選取 [建立]。 接下來您將會看到語言模型的資料表。 資料表中將會有對應此模型的新項目。 狀態會反映模型的狀態，並且會經過幾個狀態，包括「等待中」、「處理中」和「完成」。

當模型達到「完成」狀態時，即可部署至端點。 選取 [檢視結果] 會顯示離線測試的結果 (若您已執行)。

如果您想要變更模型上某些部分的「名稱」或「描述」，您可以在語言模型資料表中，使用適當資料列中的 [編輯] 連結。

## <a name="next-steps"></a>後續步驟

- [取得您的語音服務試用訂用帳戶](https://azure.microsoft.com/try/cognitive-services/)
- [如何以 C# 辨識語音](quickstart-csharp-dotnet-windows.md)
- [Git 範例資料](https://github.com/Microsoft/Cognitive-Custom-Speech-Service)
